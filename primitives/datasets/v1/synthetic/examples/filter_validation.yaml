# Filter Validation Example
#
# Purpose: Validate filter correctness with known ground truth
# Use case: Verify bandpass filter preserves in-band signal, rejects out-of-band
#
# Test signals:
#   - 10Hz sine: Should pass through bandpass_fir (passband: 8-30Hz)
#   - 60Hz sine: Should be rejected by notch_iir (notch at 60Hz)
#
# Validation:
#   - Analyze output spectrum via FFT
#   - Check amplitude at target frequency
#   - Verify filter response matches design

dataset:
  path: "primitives/datasets/v1/synthetic"
  params:
    signal_type: "sine_wave"
    frequency_hz: 10.0  # Alpha band frequency
    duration_s: 30  # 30 seconds of data
    amplitude_uv_peak: 100.0  # 100µV peak
    seed: 42
  channels: 64  # Standard high-density EEG
  sample_rate_hz: 160

# Test filter passband preservation
kernels:
  - name: "bandpass_fir"  # Passband: 8-30Hz, should preserve 10Hz
    deadline_us: 500000

  - name: "notch_iir"  # Notch at 60Hz, should NOT affect 10Hz
    deadline_us: 500000

execution:
  warmup_windows: 5
  duration_seconds: 30
  repeat_count: 1

output:
  directory: "results"
  format: "ndjson"
  include_raw_data: true  # Keep raw output for FFT analysis

# Expected results:
#
# bandpass_fir output:
#   - 10Hz component preserved (amplitude ≈ 100µV)
#   - No significant attenuation in passband
#
# notch_iir output:
#   - 10Hz component preserved (amplitude ≈ 100µV)
#   - 60Hz would be rejected if present (not in this signal)
#
# Validation script:
#   python validate_filter_output.py results/run-<timestamp>/kernel-data/bandpass_fir/
#
# Should verify:
#   1. FFT peak at 10Hz
#   2. Peak amplitude within 5% of input (100µV)
#   3. No spurious frequencies introduced

# ---
# Alternative: Test stopband rejection
#
# To test notch rejection, change dataset parameters:
#   frequency_hz: 60.0  # Line noise frequency
#
# Then notch_iir should attenuate 60Hz signal (output amplitude << 100µV)
